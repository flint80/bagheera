<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html lang="ru_ru" xml:lang="ru_ru">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<meta name="copyright" content="(C) Copyright 2005"/>
<meta name="DC.rights.owner" content="(C) Copyright 2005"/>
<meta name="DC.Type" content="concept"/>
<meta name="DC.Title" content="Обработка HTML-страницы"/>
<meta name="DC.Relation" scheme="URI" content="../using_program/using_program.html"/>
<meta name="DC.Creator" content="Авраменко Владимир"/>
<meta name="DC.Format" content="XHTML"/>
<meta name="DC.Identifier" content="html_script"/>
<meta name="DC.Language" content="ru_RU"/>
<link rel="stylesheet" type="text/css" href="../commonltr.css"/>
<title>Обработка HTML-страницы</title>
</head>
<body id="html_script"><a name="html_script"><!-- --></a>


	<h1 class="title topictitle1">Обработка HTML-страницы</h1>

	<div class="body conbody">
		<div class="fig fignone"><span class="figcap">Figure 1. Логика обработки HTML-страницы</span>
			
			<p class="p">
				<img class="image" src="figures/html_logic.png" width="300"/>
			</p>

		</div>

		<div class="p">
			В этом разделе описана логика обработки HTML-страницы, шаблон которой
			задается декоратором
			<span class="keyword cmdname">HTMLDecorator.groovy</span>
			. Более детальную информацию по методам декоратора
			можно посмотреть в
			разделе
			<a class="xref" href="../appendices/html_api.html" title="В этом приложении описаны функции, добавленные HTMLPageDecorator.groovy">HTMLPageDecorator</a>
			, либо анализируя код
			<span class="keyword cmdname">HTMLDecorator.groovy</span>
			. Обработка HTML-страницы состоит из следующих этапов:
			<ol class="ol">
				<li class="li">
					<strong class="ph b">Определение адреса страницы и HTML содержимого.</strong>
					Для создания книги необходимо ввести оба этих аттрибута.
					URL позволяет загрузить полный код страницы, из которого определяется название статьи.
					HTML содержимое - это лишь часть полного кода страницы (обычно, без шапки и футеров).
					Для выделения контента статьи удобно пользоваться FireBug.
				</li>

				<li class="li">
					<strong class="ph b">Определения названия статьи</strong>
					По указанному URL загружается полный код страницы, из которого выделяется содержимое тега <span class="keyword cmdname">title</span>.
				</li>

				<li class="li">
					<strong class="ph b">Корректировка ссылок на изображения</strong>
					Относительные пути к изображениям заменяются на полные. 
				</li>

				<li class="li">
					<strong class="ph b">Чистка содержимого</strong>
					Из фрагмента страницы удаляются блоки <span class="keyword cmdname">noscript</span> и <span class="keyword cmdname">iframe</span>.
				</li>

				<li class="li">
					<strong class="ph b">Постобработка содержимого</strong>
					Это опциональный блок, задав который, можно произвести дополнительные действия с содержимым книги.
				</li>

				<li class="li"><strong class="ph b">Создание FB2</strong>. На этом шаге генерируется контент FB2-книги.
				</li>

				<li class="li">
					<strong class="ph b">Сохранение книги в файл</strong>. На этом шаге контент сохраняется в файл на
					локальном диске в директории
					<span class="keyword cmdname">output</span>
					.
				</li>

			</ol>

		</div>

		<div class="p">
			Ниже приведен пример использования этого шаблона:
			<pre class="pre codeblock">
		
//@ description HTML страница

showMessage 'готовим книжку - ждите...'
html()
showMessage 'книжка успешно создана'
		</pre>

		</div>

		<p class="p">
			Это простеший скрипт, в котором не используется дополнительная обработка контента страницы.
			Не надо ждать идеальной отработки скрипта на произвольной страницы. Как правило, в книгу попадает много
			"мусорного" кода. Однако, на мой взгляд, для оперативного создания небольшой книги из HTML странички этого достаточно.
		</p>

	</div>

<div class="related-links">
<div class="familylinks">
<div class="parentlink"><strong>Parent topic:</strong> <a class="link" href="../using_program/using_program.html" title="В этой части более подробно рассмотрено использование прораммы Багира">Использование программы</a></div>
</div>
</div>

</body>
</html>